#!/bin/bash
apt update -y
apt install nginx git -y

cd /var/www/html
rm -rf *

git clone https://github.com/iajithmanoharan/multi-cloud-ha-failover-observability.git

cd multi-cloud-ha-failover-observability/site

cp -r * /var/www/html/

# Inject AWS Banner
INSTANCE_ID=$(curl -s http://169.254.169.254/latest/meta-data/instance-id)
REGION=$(curl -s http://169.254.169.254/latest/meta-data/placement/region)

sed -i "s/CLOUD_NAME/AWS PRIMARY/" /var/www/html/index.html
echo "<p>Instance: $INSTANCE_ID | Region: $REGION</p>" >> /var/www/html/index.html

systemctl restart nginx
